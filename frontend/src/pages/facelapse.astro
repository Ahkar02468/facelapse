---
import H1 from "../components/h1.astro";
import ErrorToast from "../components/ErrorToast.astro";
import UploadButton from "../components/upload-button.astro";
import InfoLayout from "../layouts/InfoLayout.astro";
import { Image } from "astro:assets";
---

<InfoLayout>
	<div
		id="main-container"
		class="p-4 sm:pt-8 pb-8 min-h-dvh flex flex-col justify-center items-center gap-6"
	>
		<div id="controls-container" class="flex flex-col items-center gap-2 w-full max-w-2xl">
			<H1>faceLAPSE</H1>

			<form id="upload-form" class="flex flex-col items-center gap-4 w-full">
				<div class="segmented">
					<label class="segmented-button">
						<input
							type="radio"
							name="sort_order"
							value="young-to-old"
							checked
						/>
						<span class="label-text">Young to Old</span>
					</label>
					<label class="segmented-button">
						<input
							type="radio"
							name="sort_order"
							value="old-to-young"
						/>
						<span class="label-text">Old to Young</span>
					</label>
				</div>

				<UploadButton />
			</form>

			<ErrorToast />

			<div
				id="status"
				class="text-lg text-zinc-300 bg-zinc-800 border border-zinc-700 px-6 py-3 rounded-lg shadow-md"
			>
				<span id="status-text"></span>
			</div>

			<div id="action-buttons" class="flex items-center justify-center gap-2" style="display: none;">
				<a
				  id="download-button"
				  href="#"
				  download
				  class="bg-zinc-600 hover:bg-zinc-500 transition-colors text-white font-semibold px-4 py-1 rounded-md"
				  >Download</a
				>
				<button
				  id="start-new-button"
				  class="bg-blue-600 hover:bg-blue-500 transition-colors text-white font-semibold px-4 py-1 rounded-md"
				  >Start New</button>
			  </div>
		</div>

		<div id="video-container" class="w-full max-w-2xl mt-8">
			<video
				id="timelapse-video"
				controls
				class="rounded-lg shadow-xl border border-zinc-700 bg-black"
				style="display: none; width: 100%;"></video>
		</div>

		<Image
			height={500}
			width={500}
			src="/image-thumbnail.svg"
			alt="faceLAPSE"
			id="placeholder-image"
		/>
	</div>
</InfoLayout>

<script src="../components/scripts/facelapse.js"></script>
<script src="../components/scripts/upload.js"></script>

<style>
	.segmented {
		display: flex;
		border: 1px solid #4a4a4a;
		border-radius: 0.5rem;
		overflow: hidden;
		background-color: #27272a; /* zinc-800 */
		font-family: sans-serif;
	}

	.segmented-button {
		position: relative;
		flex: 1;
	}

	.segmented-button input {
		position: absolute;
		opacity: 0;
		width: 0;
		height: 0;
		pointer-events: none;
	}

	.segmented-button .label-text {
		display: block;
		padding: 0.75rem 1.5rem;
		text-align: center;
		cursor: pointer;
		color: #a1a1aa; /* zinc-400 */
		transition:
			background-color 0.2s ease-in-out,
			color 0.2s ease-in-out;
		z-index: 1;
		position: relative;
	}

	/* Hover effect */
	.segmented-button:hover .label-text {
		background-color: #3f3f46; /* zinc-700 */
	}

	/* Checked state styles */
	.segmented-button input:checked + .label-text {
		background-color: #52525b; /* zinc-600 */
		color: white;
		font-weight: 600;
	}

	/* Focus outline for accessibility */
	.segmented-button input:focus-visible + .label-text {
		outline: 2px solid #007acc;
		outline-offset: -2px;
		border-radius: 0.375rem;
	}

	/* Hide the status container when it has no text content */
	#status:has(> span:empty) {
		display: none;
	}
</style>
